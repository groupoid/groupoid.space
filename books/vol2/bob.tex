\documentclass{article}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{url}
\usepackage{tikz-cd}
\usepackage[utf8]{inputenc}

\setlength{\parindent}{15pt}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}

\lstset{basicstyle=\footnotesize,inputencoding=utf8,
literate=
{ùüé}{{\ensuremath{\mathbf{0}}}}1
{ùüè}{{\ensuremath{\mathbf{1}}}}1
{‚âî}{{\ensuremath{\mathrm{:=}}}}1
{Œ±}{{\ensuremath{\mathrm{\alpha}}}}1
{·µÇ}{{\ensuremath{^W}}}1
{Œ≤}{{\ensuremath{\mathrm{\beta}}}}1
{Œ≥}{{\ensuremath{\mathrm{\gamma}}}}1
{Œ¥}{{\ensuremath{\mathrm{\delta}}}}1
{Œµ}{{\ensuremath{\mathrm{\varepsilon}}}}1
{Œ∂}{{\ensuremath{\mathrm{\zeta}}}}1
{Œ∑}{{\ensuremath{\mathrm{\eta}}}}1
{Œ∏}{{\ensuremath{\mathrm{\theta}}}}1
{Œπ}{{\ensuremath{\mathrm{\iota}}}}1
{Œ∫}{{\ensuremath{\mathrm{\kappa}}}}1
{Œª}{{\ensuremath{\mathrm{\lambda}}}}1
{Œº}{{\ensuremath{\mathrm{\mu}}}}1
{ŒΩ}{{\ensuremath{\mathrm{\nu}}}}1
{Œæ}{{\ensuremath{\mathrm{\xi}}}}1
{œÄ}{{\ensuremath{\mathrm{\mathnormal{\pi}}}}}1
{œÅ}{{\ensuremath{\mathrm{\rho}}}}1
{œÉ}{{\ensuremath{\mathrm{\sigma}}}}1
{œÑ}{{\ensuremath{\mathrm{\tau}}}}1
{œÜ}{{\ensuremath{\mathrm{\varphi}}}}1
{œá}{{\ensuremath{\mathrm{\chi}}}}1
{œà}{{\ensuremath{\mathrm{\psi}}}}1
{œâ}{{\ensuremath{\mathrm{\omega}}}}1
{Œ†}{{\ensuremath{\mathrm{\Pi}}}}1
{Œì}{{\ensuremath{\mathrm{\Gamma}}}}1
{Œî}{{\ensuremath{\mathrm{\Delta}}}}1
{Œò}{{\ensuremath{\mathrm{\Theta}}}}1
{Œõ}{{\ensuremath{\mathrm{\Lambda}}}}1
{Œ£}{{\ensuremath{\mathrm{\Sigma}}}}1
{Œ¶}{{\ensuremath{\mathrm{\Phi}}}}1
{Œû}{{\ensuremath{\mathrm{\Xi}}}}1
{Œ®}{{\ensuremath{\mathrm{\Psi}}}}1
{Œ©}{{\ensuremath{\mathrm{\Omega}}}}1
{‚Ñµ}{{\ensuremath{\aleph}}}1
{‚â§}{{\ensuremath{\leq}}}1
{‚â•}{{\ensuremath{\geq}}}1
{‚â†}{{\ensuremath{\neq}}}1
{‚âà}{{\ensuremath{\approx}}}1
{‚â°}{{\ensuremath{\equiv}}}1
{‚âÉ}{{\ensuremath{\simeq}}}1
{‚â§}{{\ensuremath{\leq}}}1
{‚â•}{{\ensuremath{\geq}}}1
{‚àÇ}{{\ensuremath{\partial}}}1
{‚àÜ}{{\ensuremath{\triangle}}}1 % or \laplace?
{‚à´}{{\ensuremath{\int}}}1
{‚àë}{{\ensuremath{\mathrm{\Sigma}}}}1
{‚Üí}{{\ensuremath{\rightarrow}}}1
{‚ä•}{{\ensuremath{\perp}}}1
{‚àû}{{\ensuremath{\infty}}}1
{‚àÇ}{{\ensuremath{\partial}}}1
{‚àì}{{\ensuremath{\mp}}}1
{¬±}{{\ensuremath{\pm}}}1
{√ó}{{\ensuremath{\times}}}1
{‚äï}{{\ensuremath{\oplus}}}1
{‚äó}{{\ensuremath{\otimes}}}1
{‚äû}{{\ensuremath{\boxplus}}}1
{‚àá}{{\ensuremath{\nabla}}}1
{‚àö}{{\ensuremath{\sqrt}}}1
{‚¨ù}{{\ensuremath{\cdot}}}1
{‚Ä¢}{{\ensuremath{\cdot}}}1
{‚àò}{{\ensuremath{\circ}}}1
{‚Åª}{{\ensuremath{^{-}}}}1
{‚ñ∏}{{\ensuremath{\blacktriangleright}}}1
{‚àß}{{\ensuremath{\wedge}}}1
{‚à®}{{\ensuremath{\vee}}}1
{¬¨}{{\ensuremath{\neg}}}1
{‚ä¢}{{\ensuremath{\vdash}}}1
{‚ü®}{{\ensuremath{\langle}}}1
{‚ü©}{{\ensuremath{\rangle}}}1
{‚Ü¶}{{\ensuremath{\mapsto}}}1
{‚Üí}{{\ensuremath{\rightarrow}}}1
{‚Üî}{{\ensuremath{\leftrightarrow}}}1
{‚áí}{{\ensuremath{\Rightarrow}}}1
{‚üπ}{{\ensuremath{\Longrightarrow}}}1
{‚áê}{{\ensuremath{\Leftarrow}}}1
{‚ü∏}{{\ensuremath{\Longleftarrow}}}1
{‚à©}{{\ensuremath{\cap}}}1
{‚à™}{{\ensuremath{\cup}}}1
{‚äÇ}{{\ensuremath{\subseteq}}}1
{‚äÜ}{{\ensuremath{\subseteq}}}1
{‚äÑ}{{\ensuremath{\nsubseteq}}}1
{‚äà}{{\ensuremath{\nsubseteq}}}1
{‚äÉ}{{\ensuremath{\supseteq}}}1
{‚äá}{{\ensuremath{\supseteq}}}1
{‚äÖ}{{\ensuremath{\nsupseteq}}}1
{‚äâ}{{\ensuremath{\nsupseteq}}}1
{‚àà}{{\ensuremath{\in}}}1
{‚àâ}{{\ensuremath{\notin}}}1
{‚àã}{{\ensuremath{\ni}}}1
{‚àå}{{\ensuremath{\notni}}}1
{‚àÖ}{{\ensuremath{\emptyset}}}1
{‚àñ}{{\ensuremath{\setminus}}}1
{‚Ä†}{{\ensuremath{\dag}}}1
{‚Ñï}{{\ensuremath{\mathbb{N}}}}1
{‚Ñ§}{{\ensuremath{\mathbb{Z}}}}1
{‚Ñù}{{\ensuremath{\mathbb{R}}}}1
{‚Ñö}{{\ensuremath{\mathbb{Q}}}}1
{‚ÑÇ}{{\ensuremath{\mathbb{C}}}}1
{‚åû}{{\ensuremath{\llcorner}}}1
{‚åü}{{\ensuremath{\lrcorner}}}1
{‚¶É}{{\ensuremath{ \{\!| }}}1
{‚¶Ñ}{{\ensuremath{ |\!\} }}}1
{‚ÇÅ}{{\ensuremath{_1}}}1
{‚ÇÇ}{{\ensuremath{_2}}}1
{‚ÇÉ}{{\ensuremath{_3}}}1
{‚ÇÑ}{{\ensuremath{_4}}}1
{‚ÇÖ}{{\ensuremath{_5}}}1
{‚ÇÜ}{{\ensuremath{_6}}}1
{‚Çá}{{\ensuremath{_7}}}1
{‚Çà}{{\ensuremath{_8}}}1
{‚Çâ}{{\ensuremath{_9}}}1
{‚ÇÄ}{{\ensuremath{_0}}}1
{¬π}{{\ensuremath{^1}}}1
{‚Çô}{{\ensuremath{_n}}}1
{‚Çò}{{\ensuremath{_m}}}1
{‚Üë}{{\ensuremath{\uparrow}}}1
{‚Üì}{{\ensuremath{\downarrow}}}1
{‚ñ∏}{{\ensuremath{\triangleright}}}1
{‚àÄ}{{\ensuremath{\forall}}}1
{‚àÉ}{{\ensuremath{\exists}}}1
{Œª}{{\ensuremath{\mathrm{\lambda}}}}1
{=}{{\ensuremath{=}}}1
{<}{{\ensuremath{\langle}}}1
{>}{{\ensuremath{\rangle}}}1
{(}{(}1
{(}{(}1
{‚Äñ}{‚Äñ}1
{+}{{+}}1
{*}{{*}}1,
}

\begin{document}

\title{Issue VIII: Symmetric Interpreter}
\author{Maksym Sokhatskyi $^1$}
\date{ $^1$ National Technical University of Ukraine \\
       \small Igor Sikorsky Kyiv Polytechnical Institute \\
       \today }

\maketitle

\begin{abstract}

Minimal language for parallel computations in symmetric monoidal categories. \\
{\bf Keywords}: Interaction Networks, Symmetric Monoidal Categories
\end{abstract}

\ifincludeTOC
  \tableofcontents
\fi

\newpage

\epigraph{–ü—Ä–∏—Å–≤—è—á—É—î—Ç—å—Å—è –∞–≤—Ç–æ—Ä—É Interaction Networks Combinators}{–Ü–≤—É –õ–∞—Ñ–æ–Ω—É}

\section{The Yves Language}

–ú–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è $\mathbf{Yves}$ ‚Äî —Ü–µ –≤–Ω—É—Ç—Ä—ñ—à–Ω—è –º–æ–≤–∞ —Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –º–æ–Ω–æ—ó–¥–∞–ª—å–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π,
—â–æ —Ä–µ–∞–ª—ñ–∑—É—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –≤–∑–∞—î–º–æ–¥—ñ—é –∫–æ–º–±—ñ–Ω–∞—Ç–æ—Ä—ñ–≤ ($\zeta$, $\delta$, $\epsilon$) –∑ –ø—Ä–∞–≤–∏–ª–∞–º–∏
–∞–Ω—ñ–≥—ñ–ª—è—Ü—ñ—ó —Ç–∞ –∫–æ–º—É—Ç–∞—Ü—ñ—ó, –ø—Ä–∏–¥–∞—Ç–Ω–∞ –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –ª—ñ–Ω—ñ–π–Ω–∏—Ö —ñ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º.

\subsection{–°–∏–Ω—Ç–∞–∫—Å–∏—Å}

\begin{definition}
–¢–µ—Ä–º–∏ $\mathbf{Yves}$ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑—ñ –∑–º—ñ–Ω–Ω–∏—Ö, –∫–æ–º–±—ñ–Ω–∞—Ç–æ—Ä—ñ–≤ (Con, Dup, Era), –ø–∞—Ä, –æ–±–º—ñ–Ω—É (Swap),
–∑–≤‚Äô—è–∑—É–≤–∞–Ω–Ω—è (Let) —Ç–∞ –æ–¥–∏–Ω–∏—Ü—ñ (Unit). –ú–æ–≤–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞—Ñ—ñ–Ω–Ω—É –ª–æ–≥—ñ–∫—É, –∑–∞–±–æ—Ä–æ–Ω—è—é—á–∏ –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö.
\begin{lstlisting}[mathescape=true]
I = #identifier
Y = I | Con Y  | Dup Y | Era Y
      | Pair (Y, Y)    | Unit
      | Let (I, Y, Y)  | Swap Y
\end{lstlisting}
\end{definition}

\begin{definition}
–ö–æ–¥—É–≤–∞–Ω–Ω—è —Ç–µ—Ä–º—ñ–≤ —É –º–æ–≤—ñ OCaml:
\begin{lstlisting}[mathescape=true]
type term =
    | Var of string
    | Con of term
    | Dup of term
    | Era of term
    | Pair of term * term
    | Swap of term
    | Let of string * term * term
    | Unit
\end{lstlisting}
\end{definition}

\subsection{–°–µ–º–∞–Ω—Ç–∏–∫–∞}

\begin{theorem}
–ü—Ä–∞–≤–∏–ª–∞ –æ–±—á–∏—Å–ª–µ–Ω—å —É $\mathbf{Yves}$ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ –∞–Ω—ñ–≥—ñ–ª—è—Ü—ñ—ó —Ç–∞ –∫–æ–º—É—Ç–∞—Ü—ñ—ó –∫–æ–º–±—ñ–Ω–∞—Ç–æ—Ä—ñ–≤:
\begin{lstlisting}[mathescape=true]
Con (Con x) ‚Üí Pair (x, x)
Dup (Dup x) ‚Üí Pair (x, x)
Era (Era x) ‚Üí Unit
Con (Dup x) ‚Üí Dup (Con x)
Con (Era x) ‚Üí Pair (Era x, Era x)
Dup (Era x) ‚Üí Pair (Era x, Era x)
Swap (Pair (t, u)) ‚Üí Pair (u, t)
Let (x, t, u) ‚Üí subst x t u
\end{lstlisting}
\end{theorem}

\begin{equation}
\tag{$\zeta$-annihilation}
\dfrac
{\zeta (\zeta (x))}
{(x, x)}
\end{equation}

\begin{equation}
\tag{$\delta$-annihilation}
\dfrac
{\delta (\delta (x))}
{(x, x)}
\end{equation}

\begin{equation}
\tag{$\epsilon$-annihilation}
\dfrac
{\varepsilon (\varepsilon (x))}
{\mathbf{1}}
\end{equation}

\subsubsection{–ü—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞}

\begin{definition}
–ü—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ $\mathbf{Yves}$:
\begin{lstlisting}[mathescape=true]
let rec subst env var term = function
    | Var v ->
        if v = var then
            if is_bound var env then failwith "Affine violation: variable used twice"
            else term
        else Var v
    | Con t -> Con (subst env var term t)
    | Dup t -> Dup (subst env var term t)
    | Era t -> Era (subst env var term t)
    | Pair (t, u) -> Pair (subst env var term t, subst env var term u)
    | Swap t -> Swap (subst env var term t)
    | Let (x, t1, t2) ->
        let t1' = subst env var term t1 in
        if x = var then Let (x, t1', t2)
        else Let (x, t1', subst env var term t2)
    | Unit -> Unit
\end{lstlisting}
\end{definition}

\subsubsection{–†–µ–¥—É–∫—Ü—ñ—è}

\begin{definition}
–†–µ–¥—É–∫—Ü—ñ—è —Ç–µ—Ä–º—ñ–≤ —É $\mathbf{Yves}$:
\begin{lstlisting}[mathescape=true]
let reduce env term =
    match term with
    | Con (Con x) -> Pair (x, x)
    | Dup (Dup x) -> Pair (x, x)
    | Era (Era x) -> Unit
    | Con (Dup x) -> Dup (Con x)
    | Con (Era x) -> Pair (Era x, Era x)
    | Dup (Era x) -> Pair (Era x, Era x)
    | Swap (Pair (t, u)) -> Pair (u, t)
    | Let (x, t, u) -> subst env x t u
    | _ -> term
\end{lstlisting}
\end{definition}

\subsubsection{–ü–æ—à—É–∫ –ø–∞—Ä}

\begin{definition}
–ü–æ—à—É–∫ –∞–∫—Ç–∏–≤–Ω–∏—Ö –ø–∞—Ä –¥–ª—è —Ä–µ–¥—É–∫—Ü—ñ—ó:
\begin{lstlisting}[mathescape=true]
let rec find_redexes env term acc =
    match term with
    | Con (Con x) -> (term, Pair (x, x)) :: acc
    | Dup (Dup x) -> (term, Pair (x, x)) :: acc
    | Era (Era x) -> (term, Unit) :: acc
    | Con (Dup x) -> (term, Dup (Con x)) :: acc
    | Con (Era x) -> (term, Pair (Era x, Era x)) :: acc
    | Dup (Era x) -> (term, Pair (Era x, Era x)) :: acc
    | Swap (Pair (t, u)) -> (term, Pair (u, t)) :: acc
    | Let (x, t, u) -> (term, subst env x t u) :: find_redexes env t (find_redexes env u acc)
    | Con t ->
        (match t with
         | Dup _ | Era _ -> acc
         | Con x -> find_redexes env t ((term, reduce env term) :: acc)
         | _ -> find_redexes env t acc)
    | Dup t -> find_redexes env t acc
    | Era t -> find_redexes env t acc
    | Pair (t, u) ->
        let acc' = find_redexes env t acc in
        find_redexes env u acc'
    | Swap t -> find_redexes env t acc
    | Var _ | Unit -> acc
\end{lstlisting}
\end{definition}

\subsubsection{–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ —Ä–µ–¥—É–∫—Ü—ñ—è}

\begin{definition}
–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ —Ä–µ–¥—É–∫—Ü—ñ—è:
\begin{lstlisting}[mathescape=true]
let eval_parallel pool env term =
    let rec loop term =
        let redexes = find_redexes env term [] in
        if redexes = [] then term
        else
            let new_term = Task.run pool (fun () ->
                List.fold_left
                    (fun acc (old_t, new_t) -> replace_subterm old_t new_t acc)
                    term redexes
            ) in
            loop new_term
    in
    loop term
\end{lstlisting}
\end{definition}

\subsubsection{–í–Ω—É—Ç—Ä—ñ—à–Ω—è –º–æ–≤–∞ –°–ú–ö}

\begin{theorem}
–î–æ–≤–µ–¥–µ–Ω–Ω—è, —â–æ –º–æ–≤–∞ $\mathbf{Yves}$ —î –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—é –º–æ–≤–æ—é —Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –º–æ–Ω–æ—ó–¥–∞–ª—å–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π:
\[
\begin{cases}
   \mathrm{Let} : A \to C (u \cdot t, t: A \to B, u: B \to C), \\
   \mathrm{Pair} : A \rightarrow B \rightarrow A \otimes B, \\
   \mathrm{Swap} : A \otimes B \rightarrow B \otimes A, \\
   \mathrm{Con} : A \otimes A \rightarrow A, \\
   \mathrm{Dup} : A \rightarrow A \otimes A, \\
   \mathrm{Era} : A \rightarrow \mathbf{1}, \\
   \mathrm{Var} : A, \\
   \mathrm{Unit} : \mathbf{1}.
\end{cases}
\]
\end{theorem}

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∞–∫—Å—ñ–æ–º–∞–º –°–ú–ö:

- $\mathrm{Pair}$ –º–æ–¥–µ–ª—é—î —Ç–µ–Ω–∑–æ—Ä–Ω–∏–π –¥–æ–±—É—Ç–æ–∫ $\otimes$.
- $\mathrm{Swap}$ —Ä–µ–∞–ª—ñ–∑—É—î —Å–∏–º–µ—Ç—Ä—ñ—é $\sigma_{A,B}$ –∑ —É–º–æ–≤–æ—é $\sigma_{B,A} \circ \sigma_{A,B} = \mathrm{id}_{A \otimes B}$.
- $\mathrm{Unit}$ —î –æ–¥–∏–Ω–∏—á–Ω–∏–º –æ–±'—î–∫—Ç–æ–º $I$ –¥–ª—è —è–∫–æ–≥–æ $A \otimes I \cong A$.
- $\mathrm{Let}$ –º–æ–¥–µ–ª—é—î –∫–æ–º–ø–æ–∑–∏—Ü—ñ—é –º–æ—Ä—Ñ—ñ–∑–º—ñ–≤ (–∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å).
- $\mathrm{Dup}$ —Ç–∞ $\mathrm{Era}$ —É—Ç–≤–æ—Ä—é—é—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–æ–Ω–æ—ó–¥–∞.
- $\mathrm{Con}$ –¥—ñ—î —è–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ü—ñ—è.

–õ—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—è —ñ –∞–ø–ª—ñ–∫–∞—Ü—ñ—è:

\[
\begin{cases}
  \lambda x.t \vdash \mathrm{Con}(\mathrm{Let}(x,\mathrm{Var}(x),t)), \\
  t u \mapsto \mathrm{Con}(\mathrm{Pair}(t,u)).
\end{cases}
\]

\end{document}